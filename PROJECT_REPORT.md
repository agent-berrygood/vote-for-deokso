# 덕소교회 항존직 선거 시스템 - 개발 진행 보고서

**작성일**: 2026년 2월 11일 (최종 업데이트)
**작성자**: Antigravity (AI Assistant)
**프로젝트명**: Vote for Deokso (Next.js + Firebase)

---

## 1. 프로젝트 개요
본 프로젝트는 **덕소교회 항존직 선거**를 위한 온라인 투표 시스템 구축을 목표로 합니다.
관리자가 쉽고 안전하게 선거를 운영할 수 있는 **어드민 대시보드**와, 유권자가 간편하게 인증하고 투표할 수 있는 **모바일 최적화 투표 페이지**, 그리고 실시간 개표 현황을 보여주는 **결과 페이지**로 구성되어 있습니다.

## 2. 주요 구현 기능 (Completed Features)

### A. 어드민(관리자) 시스템
1.  **관리자 로그인 및 보안**
    *   `/admin` 경로 접속 시 비밀번호 인증 요구.
    *   세션(Session) 기반 인증 유지로 비인가 접근 차단.
2.  **선거 데이터 관리 (Data Management)**
    *   **선거 생성 및 전환**: 여러 선거(예: `default-2026`, `test-v1`)를 생성하고 자유롭게 전환하며 관리 가능.
    *   **데이터 초기화(Reset)**: 'Danger Zone'을 통해 후보자 및 선거인 명부를 일괄 삭제하는 기능.
    *   **투표 일정 관리 (Schedule Control)**: [NEW]
        *   투표 시작 일시와 종료 일시를 지정하여, 해당 시간 외에는 투표 페이지 접근을 원천 차단.
3.  **후보자 및 유권자 관리**
    *   **CSV/Excel 일괄 업로드**: 엑셀(.xlsx, .xls) 및 CSV로 정리된 후보자/유권자 명단을 한 번에 등록.
    *   **이미지 최적화 및 업로드 (Image Handling)**: [Updated]
        *   **서버 직접 업로드**: 어드민 페이지에서 후보자 사진을 개별 또는 일괄(Bulk)로 직접 업로드 가능.
        *   **일괄 업로드 매칭**: `이름_생년월일_직분.jpg` 형식의 파일명을 자동 분석하여 후보자와 매칭.
        *   **자동 리사이징**: 업로드 시 300px(웹 최적화)로 자동 압축하여 Firebase Storage에 저장.
        *   구글 드라이브 의존성을 제거하고 관리 편의성 대폭 향상.

### B. 유권자 인증 및 투표 (Voter Auth & UX)
1.  **사용자 경험 개선 (UX Improvements)** [NEW]
    *   **전화번호 자동 서식**: 로그인 시 전화번호 입력(01012345678)을 `010-1234-5678`로 자동 변환하여 오타 방지.
    *   **초성 검색 및 정렬**: 후보자 목록에서 이름 초성(ㄱ, ㄴ... ㅎ)으로 필터링하거나 가나다순/역순 정렬 가능.
    *   **모바일 최적화**: 모든 화면 요소가 모바일 기기에 맞춰 반응형으로 동작.
2.  **2단계 본인 인증 프로세스**
    *   **1단계**: 이름, 전화번호, 생년월일(6자리)을 입력하여 선거인 명부와 대조.
    *   **2단계**: 일치 시 카카오 알림톡(Mock)으로 **7자리 인증번호** 발송 -> 입력 후 로그인.
    *   **투표 시간 제한**: 관리자가 설정한 투표 시간 외에는 "투표 시작 전" 또는 "종료됨" 메시지와 함께 로그인 차단.

### C. 실시간 결과 페이지 (Results)
1.  **공개 개표 현황판**
    *   `/vote/result` (또는 `/results`) 페이지를 통해 실시간 득표 현황 열람 가능.
    *   **차수별/직책별 필터링**: 1~5차 투표 및 장로/권사/안수집사별 집계 확인.
2.  **시각화 및 엑셀 다운로드**
    *   득표율 막대 그래프 및 당선 기준(2/3, 1/2) 통과 시 **'피택' 뱃지** 자동 표시.
    *   현재 개표 결과를 **엑셀(CSV) 파일로 다운로드**하는 기능 제공.

---

## 3. 기술적 특이사항 (Technical Highlights)

*   **프레임워크**: Next.js 16 (App Router) + TypeScript
*   **데이터베이스**: Firebase Firestore (NoSQL)
*   **UI 라이브러리**: Material UI (MUI) - 모바일 반응형 디자인 적용
*   **성능 최적화**:
    *   이미지 리사이징 스크립트(`sharp`) 적용으로 로딩 속도 100배 향상.
    *   대량 데이터 처리 시 `Firestore Batch` Chunking Logic 적용.
*   **보안**:
    *   민감 정보(API Key, Password)는 `.env` 환경변수로 분리.
    *   클라이언트 측 검증(Frontend)과 서버 측 검증(Backend/Rules) 이중화.

---

## 4. 향후 계획 (Next Steps)

1.  **카카오 알림톡 실연동**
    *   [카카오 비즈니스 채널 승인] 및 [알리고/솔라피] 등 대행사 계약 완료 필요.
    *   완료 시 제공된 `KAKAO_INTEGRATION_GUIDE.md`에 따라 API Key만 입력하면 즉시 사용 가능.
2.  **실제 데이터 리허설**
    *   실제 선거인 명부(수천 명 단위)를 업로드하여 퍼포먼스 최종 점검.
3.  **최종 배포 (Final Deployment)**
    *   Vercel을 통한 상용 배포 완료 (현재 Staging 상태).
    *   도메인 연결 및 SSL 인증서 적용 (Vercel 자동 처리).

---
**비고**: 위 내용은 현재 시점(2026-02-11 16:30) 기준으로 개발 및 배포가 완료된 최종 사항입니다.
